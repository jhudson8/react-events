/*!
 * [react-events](https://github.com/jhudson8/react-events) v0.7.1;  MIT license; Joe Hudson<joehud_AT_gmail.com>
 */
!function(t){"function"==typeof define&&define.amd?define([],function(){return t}):"undefined"!=typeof exports&&"undefined"!=typeof require?module.exports=function(n){t(n)}:t(React)}(function(t){function n(n,e){var i={type:n};for(var r in e)i[r]=e[r];var o=t.mixins.getState("__watchedEvents",this);o||(o=[],h({__watchedEvents:o},this)),i.context=i.context||this,o.push(i);var f=a(i.target,this);if(this.isMounted()&&f&&f[i.type](i.event,i.callback,i.context),"off"===n)for(var c,l=0;l<o.length;l++)c=o[l],c.event===e.event&&c.callback===e.callback&&a(c.target,this)===f&&o.splice(l,1)}function e(t){var n=v("__watchedEvents",t);if(n){var e;for(var i in n){e=n[i];var r=a(e.target,t);r&&r[e.type](e.event,e.callback,e.context)}}}function i(t,n){var e=v("__watchedEvents",n);if(e){var i;for(var r in e){i=e[r];var o=a(i.target,n);o&&o.off(i.event,i.callback,i.context)}t||h({__watchedEvents:[]},n)}}function a(t,n){return"function"==typeof t?t.call(n):t}function r(n,e,i,a){if(!a){var o,h=e;if("object"==typeof e&&(h=e.callback.call(this)),"string"==typeof e&&(o=u.indexOf(e)>=0,h=i[e]),!h)throw'no callback function exists for "'+e+'"';e=function(){return h.apply(i,o?[]:arguments)}}var v=n.match(s);if(v){var d=v[1],p=v[2].split(/\s*,\s*/),g=v[3],m=t.events.specials[d];if(m)return 1===p.length&&""===p[0]&&(p=[]),e=m.call(i,e,p),r(g,e,i,!0);throw new Error('invalid special event handler "'+d+"'")}var y=n.match(l),x=y[1];path=y[2],handler=f[x];for(var _=0;!handler&&_<c.length;_++)x.match(c[_].pattern)&&(handler=c[_].handler);if(!handler)throw'no handler registered for "'+n+'"';return handler.call(i,{key:x,path:path},e)}function o(t,n){p.handle(t,function(t,e){var i,a,r=t.path.match(l),o=r[1],f=r[2];return{on:function(){var t=n.call(this,o);t&&(a=t.state||t,t.on(f,e),i=t)},off:function(){i&&(i.off(f,e),i=void 0,a=void 0)},isStale:function(){if(!i)return!!t;var t=n.call(this,o);return t&&(t.state||t)===a?void 0:!0}}})}var f={},c=[],l=/^([^:]+):?(.*)/,s=/^\*([^\(]+)\(([^)]*)\):(.*)/,u=["forceUpdate"],h=t.mixins.setState,v=t.mixins.getState,d={standard:function(t){var n={on:t.onKey||"on",off:t.offKey||"off"},e=t.target;return function(i,a){function r(t,i){return function(){var r="function"==typeof e?e.call(i,o):e;r&&r[n[t]](o,a)}}var o=i.path;return{on:r("on",this),off:r("off",this),initialize:t.initialize}}}},p=t.events={specials:{},handle:function(t,n){"function"!=typeof n&&(n=d[n.type||"standard"](n)),t instanceof RegExp?c.push({pattern:t,handler:n}):f[t]=n}};"undefined"!=typeof window&&p.handle("window",{target:window,onKey:"addEventListener",offKey:"removeEventListener"});var g={ref:function(t){return this.refs[t]},prop:function(t){return this.props[t]}};for(var m in g)o(m,g[m]);p.handle("repeat",function(t,n){var e,i=parseInt(t.path,10);return{on:function(){e=setInterval(n,i)},off:function(){e=!!clearInterval(e)}}}),p.handle("!repeat",function(t,n){function e(t){t!==!0&&n(),setTimeout(function(){i&&requestAnimationFrame(e)},a)}var i,a=parseInt(t.path,10);return{on:function(){i=!0,e(!0)},off:function(){i=!1}}}),t.mixins.add("events",function(){function t(t,n){return function(){t.apply(n,arguments)}}var n=[{triggerWith:function(){var t=Array.prototype.slice.call(arguments),n=this;return function(){n.trigger.apply(this,t)}},getInitialState:function(){var t=[];if(h({_eventHandlers:t},this),this.events){var n;for(var e in this.events)n=r(e,this.events[e],this),n.initialize&&n.initialize.call(this),t.push(n)}return null},componentDidUpdate:function(){for(var t,n=v("_eventHandlers",this),e=0;e<n.length;e++)t=n[e],t.isStale&&t.isStale.call(this)&&(t.off.call(this),t.on.call(this))},componentDidMount:function(){for(var t=v("_eventHandlers",this),n=0;n<t.length;n++)t[n].on.call(this)},componentWillUnmount:function(){for(var t=v("_eventHandlers",this),n=0;n<t.length;n++)t[n].off.call(this)}}];if(p.mixin){var e={},i={};for(var a in p.mixin)e[a]=t(p.mixin[a],i);e.getInitialState=function(){return{__events:i}},n.push(e)}return n},"state"),t.mixins.add("listen",{componentDidMount:function(){i(!0,this),e(this)},componentWillUnmount:function(){i(!0,this)},listenTo:function(t,e,i,a){var r=e?{event:e,callback:i,target:t,context:a}:t;n.call(this,"on",r)},listenToOnce:function(t,e,i,a){var r={event:e,callback:i,target:t,context:a};n.call(this,"once",r)},stopListening:function(t,e,i,a){var r={event:e,callback:i,target:t,context:a};n.call(this,"off",r)}})});